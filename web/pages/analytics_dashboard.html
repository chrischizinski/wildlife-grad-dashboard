<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net https://cdn.plot.ly; style-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; font-src 'self' https://cdnjs.cloudflare.com; img-src 'self' data:; object-src 'none'; base-uri 'self'; form-action 'self';">
    <title>Wildlife Graduate Assistantships Analytics Dashboard</title>
    <!-- Preconnect to CDNs for better performance -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://cdn.plot.ly" crossorigin>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="../assets/css/analytics-styles.css">
</head>
<body class="analytics-dashboard">
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chart-line me-2"></i>
                Wildlife Graduate Assistantships Analytics
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="#about">About</a>
                <a class="nav-link" href="#overview">Overview</a>
                <a class="nav-link" href="#trends">Trends</a>
                <a class="nav-link" href="#geographic">Geographic</a>
                <a class="nav-link" href="#insights">Insights</a>
                <a class="nav-link" href="#export">Export</a>
            </div>
        </div>
    </nav>

    <div class="container-fluid" style="margin-top: 80px;">
        <!-- Loading Spinner -->
        <div id="loading" class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <h5 class="mt-3 text-muted">Loading graduate assistantship analytics...</h5>
        </div>

        <!-- Error Message -->
        <div id="error" class="alert alert-danger d-none" role="alert">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <span id="error-message"></span>
        </div>

        <!-- Main Content -->
        <div id="main-content" class="d-none">
            <!-- About This Dashboard Section -->
            <section id="about" class="mb-4">
                <div class="row">
                    <div class="col-12">
                        <div class="card border-primary">
                            <div class="card-header bg-primary text-white">
                                <div class="d-flex align-items-center justify-content-between">
                                    <h5 class="mb-0">
                                        <i class="fas fa-info-circle me-2"></i>
                                        About This Wildlife Graduate Assistantship Analytics Dashboard
                                    </h5>
                                    <button class="btn btn-sm btn-outline-light" type="button" data-bs-toggle="collapse"
                                            data-bs-target="#aboutContent" aria-expanded="false" aria-controls="aboutContent">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="collapse" id="aboutContent">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-lg-8">
                                            <h6 class="text-primary mb-3">
                                                <i class="fas fa-bullseye me-2"></i>Purpose & Scope
                                            </h6>
                                            <p class="mb-3">
                                                This dashboard provides comprehensive analytics for <strong>wildlife and fisheries graduate assistantship opportunities</strong>
                                                collected from academic job boards.
                                                The system automatically identifies and analyzes genuine graduate assistantships, fellowships, and PhD/Masters positions
                                                while filtering out internships, technician roles, and professional positions.
                                            </p>

                                            <h6 class="text-success mb-3">
                                                <i class="fas fa-sync-alt me-2"></i>Data Updates & Automation
                                            </h6>
                                            <ul class="mb-3">
                                                <li><strong>Weekly Updates:</strong> Automated data collection and processing via GitHub Actions</li>
                                                <li><strong>Real-time Processing:</strong> Advanced classification algorithms analyze job descriptions, requirements, and project details</li>
                                                <li><strong>Historical Tracking:</strong> Time-series data maintained for trend analysis and seasonal pattern detection</li>
                                                <li><strong>Dashboard Deployment:</strong> Automatic updates to GitHub Pages within minutes of new data collection</li>
                                            </ul>

                                            <h6 class="text-info mb-3">
                                                <i class="fas fa-chart-line me-2"></i>Analytics Features
                                            </h6>
                                            <ul class="mb-3">
                                                <li><strong>Smart Classification:</strong> AI-powered detection of true graduate assistantships (90%+ accuracy)</li>
                                                <li><strong>Discipline Analysis:</strong> Automatic categorization into Wildlife Management, Fisheries, Environmental Science, etc.</li>
                                                <li><strong>Geographic Distribution:</strong> Regional analysis with cost-of-living adjusted salary comparisons</li>
                                                <li><strong>Big 10 University Filter:</strong> Toggle to focus on positions at major research institutions</li>
                                                <li><strong>Trend Analysis:</strong> Monthly posting patterns, seasonal variations, and market insights</li>
                                            </ul>
                                        </div>

                                        <div class="col-lg-4">
                                            <div class="alert alert-warning mb-3">
                                                <h6 class="alert-heading">
                                                    <i class="fas fa-exclamation-triangle me-2"></i>Important Disclaimers
                                                </h6>
                                                <div class="small">
                                                    <p class="mb-2"><strong>Use at Your Own Discretion:</strong> This dashboard is provided for informational and research purposes only.</p>
                                                    <p class="mb-2"><strong>No Guarantees:</strong> While we strive for accuracy, we cannot guarantee the completeness or correctness of job postings or classifications.</p>
                                                    <p class="mb-2"><strong>Third-Party Data:</strong> Information is sourced from external job boards and may contain errors or outdated listings.</p>
                                                    <p class="mb-0"><strong>Not Career Advice:</strong> This tool should supplement, not replace, your own research and application strategies.</p>
                                                </div>
                                            </div>

                                            <div class="alert alert-info mb-3">
                                                <h6 class="alert-heading">
                                                    <i class="fas fa-graduation-cap me-2"></i>For Researchers & Students
                                                </h6>
                                                <div class="small">
                                                    <p class="mb-2"><strong>Academic Use:</strong> Ideal for understanding market trends, geographic patterns, and funding landscapes.</p>
                                                    <p class="mb-2"><strong>Comparative Analysis:</strong> Compare opportunities across disciplines, regions, and institution types.</p>
                                                    <p class="mb-0"><strong>Strategic Planning:</strong> Use trend data to time applications and identify emerging opportunities.</p>
                                                </div>
                                            </div>

                                            <div class="alert alert-light border">
                                                <h6 class="mb-2">
                                                    <i class="fas fa-code me-2"></i>Open Source & Methodology
                                                </h6>
                                                <div class="small text-muted">
                                                    <p class="mb-1">This project is open source and available on GitHub.</p>
                                                    <p class="mb-1">Classification algorithms and data processing methods are transparent and reproducible.</p>
                                                    <p class="mb-0">Contributions and improvements welcome from the research community.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Header Stats Banner -->
            <section id="overview" class="mb-4">
                <!-- Filter Info Panel (shown when Big 10 filter is active) -->
                <div id="filter-info-panel" class="alert alert-warning border-start border-warning border-4 mb-3" style="display: none;">
                    <div class="d-flex align-items-start">
                        <i class="fas fa-university me-3 mt-1"></i>
                        <div>
                            <h6 class="alert-heading mb-1">Big 10 Conference Filter Active</h6>
                            <p class="mb-0 small">
                                Showing positions only at Big 10 universities: Illinois, Indiana, Iowa, Maryland, Michigan,
                                Michigan State, Minnesota, Nebraska, Northwestern, Ohio State, Penn State, Purdue, Rutgers,
                                UCLA, USC, Washington, Wisconsin, and Oregon.
                            </p>
                        </div>
                        <button type="button" class="btn-close btn-sm ms-auto" onclick="document.getElementById('big10-toggle').click()"></button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="analytics-header-card">
                            <div class="row align-items-center">
                                <div class="col-md-8">
                                    <h2 class="mb-2">Verified Graduate Assistantship Analysis</h2>
                                    <p class="text-muted mb-0">
                                        <span id="data-period">Last 6 months</span> •
                                        <span id="last-updated">Last updated: Never</span> •
                                        <span id="total-positions">0 total positions</span>
                                    </p>
                                </div>
                                <div class="col-md-4 text-md-end">
                                    <div class="d-flex align-items-center justify-content-end gap-2">
                                        <small class="text-muted fw-medium">Filter by:</small>
                                        <div class="btn-group me-2">
                                            <input type="checkbox" class="btn-check" id="big10-toggle" autocomplete="off">
                                            <label class="btn btn-outline-warning btn-sm position-relative" for="big10-toggle"
                                                   data-bs-toggle="tooltip"
                                                   data-bs-placement="bottom"
                                                   data-bs-title="Toggle to show only positions at Big 10 Conference universities (18 schools including Michigan, Ohio State, Penn State, etc.)">
                                                <i class="fas fa-university me-1"></i>
                                                <span class="d-none d-md-inline">Big 10 Universities</span>
                                                <span class="d-inline d-md-none">Big 10</span>
                                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning text-dark"
                                                      id="big10-count" style="font-size: 0.65rem; display: none;">
                                                    0
                                                </span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="btn-group">
                                        <button class="btn btn-outline-primary btn-sm" id="refresh-data">
                                            <i class="fas fa-sync-alt me-1"></i>Refresh
                                        </button>
                                        <button class="btn btn-primary btn-sm" id="export-report">
                                            <i class="fas fa-download me-1"></i>Export Report
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key Metrics Cards -->
                <div class="row mb-4">
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="metric-card bg-primary text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h3 id="total-assistantships" class="mb-1">0</h3>
                                        <p class="mb-0 small">Graduate Assistantships</p>
                                        <small class="opacity-75" id="assistantship-change">+0% from last period</small>
                                    </div>
                                    <div class="metric-icon">
                                        <i class="fas fa-graduation-cap fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="metric-card bg-success text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h3 id="avg-stipend" class="mb-1">$0</h3>
                                        <p class="mb-0 small">Average Stipend</p>
                                        <small class="opacity-75">Lincoln, NE adjusted</small>
                                    </div>
                                    <div class="metric-icon">
                                        <i class="fas fa-dollar-sign fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="metric-card bg-info text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h3 id="top-discipline" class="mb-1">-</h3>
                                        <p class="mb-0 small">Leading Discipline</p>
                                        <small class="opacity-75" id="discipline-percentage">0% of positions</small>
                                    </div>
                                    <div class="metric-icon">
                                        <i class="fas fa-trophy fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="metric-card bg-warning text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h3 id="geographic-spread" class="mb-1">0</h3>
                                        <p class="mb-0 small">Regions Active</p>
                                        <small class="opacity-75" id="top-region">Top: Unknown</small>
                                    </div>
                                    <div class="metric-icon">
                                        <i class="fas fa-map-marked-alt fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Discipline Analysis Section -->
            <section id="disciplines" class="mb-5">
                <div class="row">
                    <div class="col-12">
                        <div class="analytics-card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-layer-group me-2"></i>
                                    Discipline Market Analysis
                                </h5>
                            </div>
                            <div class="card-body">
                                <!-- Discipline Cards with Enhanced Analytics -->
                                <div id="discipline-cards" class="row mb-4">
                                    <!-- Discipline cards will be populated here -->
                                </div>

                                <!-- Salary Distribution Chart -->
                                <div class="row">
                                    <div class="col-12">
                                        <canvas id="salary-comparison-chart" height="300"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Trends Analysis Section -->
            <section id="trends" class="mb-5">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="analytics-card">
                            <div class="card-header">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">
                                        <i class="fas fa-chart-line me-2"></i>
                                        Posting Trends Over Time
                                    </h5>
                                    <div class="btn-group btn-group-sm" role="group">
                                        <input type="radio" class="btn-check" name="trendPeriod" id="trend3m" value="3" checked>
                                        <label class="btn btn-outline-secondary" for="trend3m">3M</label>

                                        <input type="radio" class="btn-check" name="trendPeriod" id="trend6m" value="6">
                                        <label class="btn btn-outline-secondary" for="trend6m">6M</label>

                                        <input type="radio" class="btn-check" name="trendPeriod" id="trend1y" value="12">
                                        <label class="btn btn-outline-secondary" for="trend1y">1Y</label>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <canvas id="trends-chart" height="400"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="analytics-card h-100">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-calendar-alt me-2"></i>
                                    Seasonal Patterns
                                </h6>
                            </div>
                            <div class="card-body">
                                <div id="seasonal-insights">
                                    <!-- Seasonal analysis will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Geographic Analysis Section -->
            <section id="geographic" class="mb-5">
                <div class="analytics-card">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-globe-americas me-2"></i>
                            Geographic Distribution Analysis
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-8">
                                <div id="geographic-map" style="height: 400px;"></div>
                            </div>
                            <div class="col-lg-4">
                                <h6 class="mb-3">Regional Insights</h6>
                                <div id="regional-breakdown">
                                    <!-- Regional statistics will be populated here -->
                                </div>

                                <hr class="my-3">

                                <h6 class="mb-3">Cost of Living Impact</h6>
                                <div id="cost-of-living-analysis">
                                    <!-- Cost analysis will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Advanced Insights Section -->
            <section id="insights" class="mb-5">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="analytics-card">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-lightbulb me-2"></i>
                                    Market Insights
                                </h6>
                            </div>
                            <div class="card-body">
                                <div id="market-insights">
                                    <!-- AI-generated insights will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="analytics-card">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="fas fa-university me-2"></i>
                                    Top Organizations
                                </h6>
                            </div>
                            <div class="card-body">
                                <canvas id="organizations-chart" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Export Section -->
            <section id="export" class="mb-5">
                <div class="analytics-card">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-download me-2"></i>
                            Data Export & Research Tools
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="export-option">
                                    <div class="text-center p-3">
                                        <i class="fas fa-database fa-3x text-primary mb-3"></i>
                                        <h6>Historical Graduate Positions</h6>
                                        <p class="text-muted small">Complete dataset of verified graduate assistantships with individual listings</p>
                                        <a href="../data/historical_graduate_positions.json" class="btn btn-primary btn-sm" download="wildlife_graduate_positions.json">
                                            <i class="fas fa-download me-1"></i>Download Graduate Positions JSON
                                        </a>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <div class="export-option">
                                    <div class="text-center p-3">
                                        <i class="fas fa-archive fa-3x text-success mb-3"></i>
                                        <h6>All Historical Positions</h6>
                                        <p class="text-muted small">Complete raw dataset including all collected positions (graduate and non-graduate)</p>
                                        <a href="../data/historical_all_positions.json" class="btn btn-success btn-sm" download="wildlife_all_positions.json">
                                            <i class="fas fa-download me-1"></i>Download All Positions JSON
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-3">
                            <div class="col-12">
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    <strong>Data Usage:</strong> These datasets contain individual job listings for research purposes.
                                    The analytics dashboard above shows only aggregated trends and insights.
                                    Data is updated weekly via automated collection from academic job boards.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <footer class="bg-light mt-5 py-4 border-top">
        <div class="container">
            <div class="row mb-3">
                <div class="col-md-4">
                    <h6 class="text-primary mb-2">Wildlife Graduate Analytics</h6>
                    <p class="text-muted small mb-2">
                        <i class="fas fa-chart-line me-2"></i>
                        Automated analytics for wildlife and fisheries graduate assistantship opportunities
                    </p>
                    <p class="text-muted small mb-0" id="footer-last-updated">
                        <i class="fas fa-clock me-2"></i>
                        Last updated: Never
                    </p>
                </div>
                <div class="col-md-4">
                    <h6 class="text-primary mb-2">Data & Updates</h6>
                    <div class="small text-muted">
                        <p class="mb-1"><i class="fas fa-sync-alt me-2"></i>Weekly automated updates</p>
                        <p class="mb-1"><i class="fas fa-robot me-2"></i>AI-powered classification</p>
                        <p class="mb-0"><i class="fas fa-github me-2"></i>Open source methodology</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <h6 class="text-primary mb-2">Important Notice</h6>
                    <div class="small text-muted">
                        <p class="mb-1"><strong>Research Purposes Only:</strong> Use at your own discretion</p>
                        <p class="mb-1"><strong>No Guarantees:</strong> Accuracy not guaranteed</p>
                        <p class="mb-0"><strong>Third-Party Data:</strong> Sourced from external job boards</p>
                    </div>
                </div>
            </div>

            <hr class="my-3">

            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="text-muted small mb-0">
                        <i class="fas fa-exclamation-triangle me-2 text-warning"></i>
                        <strong>Disclaimer:</strong> This dashboard is provided for informational purposes only.
                        Users should verify all information independently and use this data at their own discretion.
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="text-muted small mb-0">
                        <i class="fas fa-database me-2"></i>
                        <span id="footer-total-positions">0</span> total positions analyzed •
                        Research-grade analytics platform
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts moved to end for better performance -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js" integrity="sha384-XiTOLGCkdNJDr6L/DZSWsFUOJHBa4FvGvXrGVqHU+vJCfKx5WzAwpxE7d0Ae3+Ks" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@sgratzl/chartjs-chart-boxplot@4.2.6/build/index.umd.min.js" integrity="sha384-HbFcBl0tEi7JXVlOQBMNWfcnJjYhGqWz4sxDZx8xJFl9JTXm3UOl2Xd7OGOWqgPQ" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js" integrity="sha384-LW3wvW4LW4K3vt0lG6w4vZXKl8JaT5gkO0vt6ljMkZpGQl0zfLCNZ8dM5y5RvPqM" crossorigin="anonymous"></script>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js" integrity="sha384-qfGk5rYAc8SdXlqz0HCGP1e8OqL+iqhRTKaE5nGpHgb9R8B9Y7qXUgX5VCqF4tJ9" crossorigin="anonymous"></script>
    <script type="module" src="../assets/js/analytics_dashboard.js"></script>
</body>
</html>
